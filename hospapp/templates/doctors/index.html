{% extends "doctors/base.html" %}

{% block title %}HMS | Doctor Home{% endblock %}
<!-- Content Wrapper. Contains page content -->
{% block content %}


<!-- NEW dashboard items-->
 {% include 'dashboardstyle.css' %}
   
<div class="container py-5">
    <!-- Dashboard Header -->
    <div class="dashboard-header mb-4">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h1 class="mb-0">Doctor's Dashboard: {%for data1 in context%} {{data1}} {%endfor%}</h1>
                <p class="mb-0 opacity-75">Fertility Clinic Management System</p>
            </div>
            <div class="text-end">
                <p class="mb-0"><i class="bi bi-calendar3"></i> {% now "l, F j, Y" %}</p>
                <p class="mb-0"><i class="bi bi-person-circle"></i> Dr. {{ user.username }}</p>
            </div>
        </div>
    </div>


    <!-- Feature Cards -->
    <div class="row g-4">
        <!-- Patient Notes Card -->
        <div class="col-md-6 col-lg-4">
            <div class="card card-feature">
                <div class="card-body d-flex flex-column justify-content-between py-4">
                    <div>
                        <div class="icon-container bg-patient">
                            <i class="bi bi-journal-medical"></i>
                        </div>
                        <h5 class="card-title">Patient Records</h5>
                        <p class="card-text">Review consultation notes, medical history, and laboratory results for your patients.</p>
                    </div>
                    <div class="mt-3">
                        <div class="d-flex justify-content-center gap-2">
                            <span class="badge bg-info">12 New Results</span>
                            <span class="badge bg-warning text-dark">3 Pending Reviews</span>
                        </div>
                    </div>
                </div>
                <div class="card-footer py-3">
                    <a href="#" class="action-link">Access Patient Records <i class="bi bi-arrow-right"></i></a>
                </div>
            </div>
        </div>

        <!-- Diagnose Card -->
        <div class="col-md-6 col-lg-4">
            <div class="card card-feature">
                <div class="card-body d-flex flex-column justify-content-between py-4">
                    <div>
                        <div class="icon-container bg-diagnose">
                            <i class="bi bi-clipboard2-pulse"></i>
                        </div>
                        <h5 class="card-title">Diagnosis & Advice</h5>
                        <p class="card-text">Diagnose conditions and provide medical advice based on patient assessments.</p>
                    </div>
                    <div class="mt-3">
                        <div class="d-flex justify-content-center gap-2">
                            <span class="badge bg-primary">8 Waiting Assessment</span>
                            <span class="badge bg-success">4 Completed Today</span>
                        </div>
                    </div>
                </div>
                <div class="card-footer py-3">
                    <a href="#" class="action-link">Start Diagnosis <i class="bi bi-arrow-right"></i></a>
                </div>
            </div>
        </div>

        <!-- Prescribe Card -->
        <div class="col-md-4 col-lg-4">
            <div class="card card-feature">
                <div class="card-body d-flex flex-column justify-content-between py-4">
                    <div>
                        <div class="icon-container bg-prescribe">
                            <i class="bi bi-prescription2"></i>
                        </div>
                        <h5 class="card-title">Prescriptions</h5>
                        <p class="card-text">Prescribe medications or fertility treatments with digital prescription system.</p>
                    </div>
                    <div class="mt-3">
                        <div class="d-flex justify-content-center gap-2">
                            <span class="badge bg-warning text-dark">5 Pending Approvals</span>
                            <span class="badge bg-success">10 Recent Prescriptions</span>
                        </div>
                    </div>
                </div>
                <div class="card-footer py-3">
                    <a href="#" class="action-link">Write Prescription <i class="bi bi-arrow-right"></i></a>
                </div>
            </div>
        </div>

        <!-- Tests Card -->
        <div class="col-md-6 col-lg-4">
            <div class="card card-feature">
                <div class="card-body d-flex flex-column justify-content-between py-4">
                    <div>
                        <div class="icon-container bg-tests">
                            <i class="bi bi-file-earmark-medical"></i>
                        </div>
                        <h5 class="card-title">Lab Tests & Scans</h5>
                        <p class="card-text">Request further diagnostic tests such as hormone assessments and ultrasound scans.</p>
                    </div>
                    <div class="mt-3">
                        <div class="d-flex justify-content-center gap-2">
                            <span class="badge bg-secondary">7 Tests Ordered</span>
                            <span class="badge bg-info">15 Results Available</span>
                        </div>
                    </div>
                </div>
                <div class="card-footer py-3">
                    <a href="#" class="action-link">Request Tests <i class="bi bi-arrow-right"></i></a>
                </div>
            </div>
        </div>

        <!-- Monitor Card -->
        <div class="col-md-6 col-lg-4">
            <div class="card card-feature">
                <div class="card-body d-flex flex-column justify-content-between py-4">
                    <div>
                        <div class="icon-container bg-monitor">
                            <i class="bi bi-graph-up"></i>
                        </div>
                        <h5 class="card-title">Treatment Monitoring</h5>
                        <p class="card-text">Monitor ongoing treatments and IVF cycles with comprehensive tracking tools.</p>
                    </div>
                    <div class="mt-3">
                        <div class="d-flex justify-content-center gap-2">
                            <span class="badge bg-primary">9 Active IVF Cycles</span>
                            <span class="badge bg-danger">2 Need Attention</span>
                        </div>
                    </div>
                </div>
                <div class="card-footer py-3">
                    <a href="#" class="action-link">View Treatment Progress <i class="bi bi-arrow-right"></i></a>
                </div>
            </div>
        </div>
        <!--Reports and data-->
        <div class="col-md-6 col-lg-4">
            <div class="card card-feature">
                <div class="card-body d-flex flex-column justify-content-between py-4">
                    <div>
                        <div class="icon-container bg-monitor">
                            <i class="bi bi-graph-up"></i>
                        </div>
                        <h5 class="card-title">Reports and Data</h5>
                        <p class="card-text">Monitor ongoing treatments and IVF cycles with comprehensive tracking tools.</p>
                    </div>
                    <div class="mt-3">
                        <div class="d-flex justify-content-center gap-2">
                            <span class="badge bg-primary">9 Active IVF Cycles</span>
                            <span class="badge bg-danger">2 Need Attention</span>
                        </div>
                    </div>
                </div>
                <div class="card-footer py-3">
                    <a href="#" class="action-link">View Treatment Progress <i class="bi bi-arrow-right"></i></a>
                </div>
            </div>
        </div>

    </div>

    <!--Statistical Graphy-->

    <div class="container py-5">
        <div class="card shadow-lg">
            <div class="card-body">
                <h4 class="text-center">Activities Chart</h4>
                <div class="row">
                    <div class="col-md-6">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title text-center">Patient Admissions (Last 7 Days)</h5>
                                <canvas id="requestedtest" height="100"></canvas>
                            </div>
                        </div>
                    </div>


                    <div class="col-md-6">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title text-center">Test Completed (Last 7 Days)</h5>
                                <canvas id="completedChart" height="100"></canvas>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!--Statistical Graphy Ends -->
    <!-- Recent Activity Section -->
    <div class="card">
        <div class="card-body">
            <div class="card-header card-info">
                <div class="d-flex justify-content-between align-items-center">
                    <h3>Recent Activity</h3>
                    <button class="btn btn-outline-primary btn-sm">View All</button>
                </div>
            </div>

            <div class="list-group list-group-flush">
                <div class="list-group-item d-flex justify-content-between align-items-center p-3">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-person-check fs-4 me-3 text-success"></i>
                        <div>
                            <p class="mb-0 fw-medium">Emily Parker - Consultation Completed</p>
                            <small class="text-muted">Fertility assessment and treatment plan created</small>
                        </div>
                    </div>
                    <small class="text-muted">10:30 AM</small>
                </div>
                <div class="list-group-item d-flex justify-content-between align-items-center p-3">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-file-earmark-text fs-4 me-3 text-primary"></i>
                        <div>
                            <p class="mb-0 fw-medium">Lab Results Received - Mark Johnson</p>
                            <small class="text-muted">Hormone profile and sperm analysis completed</small>
                        </div>
                    </div>
                    <small class="text-muted">9:15 AM</small>
                </div>
                <div class="list-group-item d-flex justify-content-between align-items-center p-3">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-calendar-check fs-4 me-3 text-warning"></i>
                        <div>
                            <p class="mb-0 fw-medium">IVF Cycle Monitoring - Sarah Williams</p>
                            <small class="text-muted">Day 8 follicle scan performed</small>
                        </div>
                    </div>
                    <small class="text-muted">Yesterday</small>
                </div>
                <div class="list-group-item d-flex justify-content-between align-items-center p-3">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-prescription fs-4 me-3 text-danger"></i>
                        <div>
                            <p class="mb-0 fw-medium">Prescription Updated - Michael Davis</p>
                            <small class="text-muted">Clomiphene dosage adjusted based on response</small>
                        </div>
                    </div>
                    <small class="text-muted">Yesterday</small>
                </div>
            </div>
        </div>
    </div>


    <!-- Content Header (Page header) -->
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0 text-dark">Dashboard</h1>
                </div><!-- /.col -->
                <!-- <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="{% url 'doctors' %}">Home</a></li>
                        <li class="breadcrumb-item active">Dashboard</li>
                    </ol>
                </div> -->
            </div><!-- /.row -->
        </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->
    <!-- 🌟 Doctor Dashboard Icons -->
    <section class="dashboard-icons py-3 my-2 rounded">
        <div class="container-fluid">
            <div class="d-flex flex-wrap justify-content-center">



                <!-- Home -->
                <div class="p-2">
                    <a href="{% url 'doctors' %}" class="bg-primary text-white p-4 text-center d-block"
                       style="width: 150px; border-radius: 30px">
                        <i class="bi bi-house-door display-4 d-block mb-2"></i>
                        <span>Home</span>
                    </a>
                </div>

                <!-- Patient Consultation -->
                <div class="p-2">
                    <a href="{% url 'doctor_consultation' %}" class="bg-success text-white p-4 text-center d-block"
                       style="width: 150px; border-radius: 30px">
                        <i class="bi bi-person-lines-fill display-4 d-block mb-2"></i>
                        <span>Consultation</span>
                    </a>
                </div>

                <!-- Patient Records -->
                <div class="p-2">
                    <a href="{% url 'access_medical_records' %}" class="bg-info text-white p-4 text-center d-block"
                       style="width: 150px; border-radius: 30px">
                        <i class="bi bi-folder2-open display-4 d-block mb-2"></i>
                        <span>Records</span>
                    </a>
                </div>

                <!-- Treatment Monitoring -->
                <div class="p-2">
                    <a href="{% url 'monitoring' %}"
                       class="bg-warning text-white p-4 text-center d-block" style="width: 150px; border-radius: 30px">
                        <i class="bi bi-activity display-4 d-block mb-2"></i>
                        <span>Monitoring</span>
                    </a>
                </div>

            </div>
        </div>
    </section>


  
                    
    <aside class="control-sidebar control-sidebar-dark">
        <!-- Control sidebar content goes here -->
    </aside>

    <!--Chart JS-->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            fetch('chart')
                .then(response => response.json())
                .then(data => {
                    // Test Requested Chart
                    const ctx1 = document.getElementById('requestedtest').getContext('2d');
                    new Chart(ctx1, {
                        type: 'bar',
                        data: {
                            labels: data.requested.labels,
                            datasets: [{
                                label: 'Requested Tests',
                                data: data.requested.counts,
                                backgroundColor: 'rgba(54, 162, 235, 0.6)',
                                borderColor: 'rgba(54, 162, 235, 1)',
                                borderWidth: 1,
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            aspectRatio: 2,
                            plugins: {
                                legend: {
                                    position: 'top'
                                },
                                title: {
                                    display: true,
                                    text: 'Daily Test Requests',
                                    font: { size: 18 }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Number of Tests'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Date'
                                    }
                                }
                            }
                        }
                    });

                    // Completed Tests Chart
                    const ctx2 = document.getElementById('completedChart').getContext('2d');
                    new Chart(ctx2, {
                        type: 'doughnut',
                        data: {
                            labels: data.completed.labels,
                            datasets: [{
                                label: 'Completed Tests',
                                data: data.completed.counts,
                                backgroundColor: 'rgba(75, 192, 192, 0.6)',
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 1,
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            aspectRatio: 2,
                            plugins: {
                                legend: {
                                    position: 'top'
                                },
                                title: {
                                    display: true,
                                    text: 'Daily Test Completions',
                                    font: { size: 18 }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Number of Tests'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Date'
                                    }
                                }
                            }
                        }
                    });
                });
        });
    </script>



    {% endblock %}
  
