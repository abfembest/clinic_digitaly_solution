{% extends "laboratory/base.html" %}

{% block title %}HMS | Lab Dashboard{% endblock %}

{% block content %}

{% include 'dashboardstyle.css' %}
  
  <!-- Content Header -->
  <section class="content-header py-3">
    <div class="container-fluid">
      <div class="row mb-2 align-items-center">
        <div class="col-sm-6">
          <h1>Lab Dashboard</h1>
          <p class="mb-0 opacity-75">Fertility Clinic Management System</p>
        </div>
        <div class="col-sm-6 text-sm-right">
          <p class="mb-0"><i class="bi bi-calendar3"></i> {% now "l, F j, Y" %}</p>
          <p class="mb-0"><i class="bi bi-person-circle"></i> Lab Staff: {{ user.username }}</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <section class="content">
    <div class="container-fluid py-3">

      <!-- Feature Cards Row -->
      <div class="row">
        <!-- Test Entry Card -->
        <div class="col-md-6 col-lg-4">
          <div class="card card-feature h-100">
            <div class="card-body d-flex flex-column justify-content-between py-4">
              <div>
                <div class="icon-container bg-primary mb-3">
                  <i class="bi bi-vial"></i>
                </div>
                <h5 class="card-title">Lab Test Entry</h5>
                <p class="card-text">Manually record and track test data results submitted by lab staff.</p>
              </div>
            </div>
            <div class="card-footer py-3">
              <a href="{% url 'lab_test_entry' %}" class="action-link">Enter Tests <i class="bi bi-arrow-right"></i></a>
            </div>
          </div>
        </div>

        <!-- Upload Results Card -->
        <div class="col-md-6 col-lg-4">
          <div class="card card-feature h-100">
            <div class="card-body d-flex flex-column justify-content-between py-4">
              <div>
                <div class="icon-container bg-success mb-3">
                  <i class="bi bi-upload"></i>
                </div>
                <h5 class="card-title">Upload Lab Results</h5>
                <p class="card-text">Upload scanned or digital reports for completed lab tests.</p>
              </div>
            </div>
            <div class="card-footer py-3">
              <a href="{% url 'lab_result_upload' %}" class="action-link">Upload Results <i class="bi bi-arrow-right"></i></a>
            </div>
          </div>
        </div>

        <!-- Internal Logs Card -->
        <div class="col-md-6 col-lg-4">
          <div class="card card-feature h-100">
            <div class="card-body d-flex flex-column justify-content-between py-4">
              <div>
                <div class="icon-container bg-info mb-3">
                  <i class="bi bi-clock-history"></i>
                </div>
                <h5 class="card-title">Test Logs</h5>
                <p class="card-text">View all completed and pending lab tests for internal record-keeping.</p>
              </div>
            </div>
            <div class="card-footer py-3">
              <a href="{% url 'lab_internal_logs' %}" class="action-link">View Logs <i class="bi bi-arrow-right"></i></a>
            </div>
          </div>
        </div>
      </div>

      <!-- Activity Chart Card -->
      <div class="card mt-4">
        <div class="card-header">
          <h3 class="card-title text-center w-100">Lab Activity Chart</h3>
        </div>
        <div class="card-body">
          <canvas id="labChart" style="max-height:300px; width:100%;"></canvas>
        </div>
      </div>

    </div>
  </section>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('labChart').getContext('2d');
  const labChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'],
      datasets: [{
        label: 'Tests Processed',
        data: [12, 19, 7, 14, 10],
        backgroundColor: 'rgba(75, 192, 192, 0.6)',
        borderColor: 'rgba(75, 192, 192, 1)',
        borderWidth: 1,
        borderRadius: 4
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
</script>

{% endblock %}
